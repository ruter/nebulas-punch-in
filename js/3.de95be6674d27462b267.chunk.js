webpackJsonp([3],{316:function(t,e,a){"use strict";function s(t){r||a(327)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(322),i=a(328),r=!1,o=a(132),c=s,l=o(n.a,i.a,!1,c,"data-v-a83bd3b0",null);l.options.__file="src/views/index.vue",e.default=l.exports},322:function(t,e,a){"use strict";var s=a(133),n=a(64),i=a(134),r=(a.n(i),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),o=new n.a;e.a={data:function(){return{address:"",tasks:[],state:{"-1":"未完成",0:"未打卡",1:"已打卡"},taskHash:"",loading:!0,timeoutObj:null}},filters:{dateInterval:function(t,e){if(t){var a="object"!==(void 0===t?"undefined":r(t))?new Date(t):t,n=new Date(a.getTime()+864e5*(e-1)),i=s.a.dateSep(a),o=s.a.dateSep(n);return i.year+"."+i.month+"."+i.day+" ~ "+o.year+"."+o.month+"."+o.day}return"未知时间"},dateDelta:function(t){return t?s.a.dateDelta(t):"?"}},watch:{address:function(){this.startApp()}},created:function(){var t=this;s.a.noWallet?(this.loading=!1,this.showError()):(this.timeoutObj=setTimeout(function(){t.loading=!1,t.showWarning()},5e3),s.a.getAccount(this))},methods:{startApp:function(){clearTimeout(this.timeoutObj),this.getValidTasks()},showError:function(){this.$Modal.warning(s.a.PocketErr)},showWarning:function(){this.$Modal.warning(s.a.WalletWarning)},getValidTasks:function(){var t=this,e=s.a.getContractAddress();o.simulateCall(e,"0","getValidTasks","[]",{listener:function(e){if(e.execute_err&&"contract check failed"==e.execute_err)t.$Modal.error({title:"网络错误",content:"请确认钱包插件网络为「Mainnet」，切换后刷新重试"});else{var a=s.a.parse(e.result);t.tasks=a.filter(function(t){return-1!==t.state&&s.a.dateDelta(t.datetime)<=t.cycle})}t.loading=!1}})},handleTaskClick:function(t){this.loading=!0,this.$router.push("/detail/"+t)},handleSearchClick:function(){this.loading=!0,this.$router.push("/detail/"+this.taskHash)},handlePunchClick:function(t){var e=this,a=this.tasks[t],n=a.hash;if(1===a.state)return void this.$Modal.info({title:"已打卡",content:"今日已打卡，无需重复操作"});this.loading=!0;var i=s.a.getContractAddress(),c=s.a.toSting([n]);o.call(i,"0","punch",c,{listener:function(s){a.state=1,e.tasks.splice(t,1,a),"object"===(void 0===s?"undefined":r(s))?e.$Modal.success({title:"打卡成功",content:"今日目标「"+a.name+"」已完成，奖励一下自己吧"}):e.$Modal.error({title:"创建失败",content:"交易被取消，打卡失败"}),e.loading=!1}})}}}},327:function(t,e){},328:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index"},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"mb32",staticStyle:{"text-align":"center"}},[a("Input",{attrs:{placeholder:"请输入要查找的打卡目标唯一 ID..."},model:{value:t.taskHash,callback:function(e){t.taskHash=e},expression:"taskHash"}},[a("Button",{attrs:{slot:"append",icon:"ios-search"},nativeOn:{click:function(e){return t.handleSearchClick(e)}},slot:"append"})],1)],1)])],1),t._v(" "),a("Row",{staticClass:"mb32",attrs:{type:"flex",justify:"center",align:"middle"}},[t._l(t.tasks,function(e,s){return a("Col",{key:e.hash,staticClass:"mr8",attrs:{span:"6"}},[a("Card",{staticClass:"text-center card-task",staticStyle:{cursor:"pointer"},nativeOn:{click:function(a){t.handleTaskClick(e.hash)}}},[a("div",{class:"gradient-"+s+" card-header"},[a("h1",[t._v("第 "+t._s(t._f("dateDelta")(e.datetime))+" 天")])]),t._v(" "),a("div",{staticClass:"card-body"},[a("h2",[t._v(t._s(e.name))]),t._v(" "),a("p",{staticClass:"ellip mt8"},[t._v(t._s(e.desc))]),t._v(" "),a("p",{staticClass:"mt8"},[t._v(t._s(t._f("dateInterval")(e.datetime,e.cycle)))]),t._v(" "),a("p",{class:"state"+e.state},[t._v(t._s(t.state[e.state]))])]),t._v(" "),a("div",{staticClass:"card-footer"},[a("Button",{attrs:{type:"ghost",shape:"circle",icon:"checkmark-round",size:"large"},on:{click:function(e){e.stopPropagation(),t.handlePunchClick(s)}}})],1)])],1)}),t._v(" "),t._l(3-t.tasks.length,function(t){return a("Col",{key:t,staticClass:"mr8",attrs:{span:"6"}},[a("router-link",{attrs:{to:"/create"}},[a("Button",{staticClass:"task-create",attrs:{type:"ghost",icon:"plus-circled",size:"large"}})],1)],1)})],2),t._v(" "),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},n=[];s._withStripped=!0;var i={render:s,staticRenderFns:n};e.a=i}});